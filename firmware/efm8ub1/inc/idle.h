/////////////////////////////////////////////////////////////////////////////
// idle.h
/////////////////////////////////////////////////////////////////////////////

#ifndef __IDLE_H__
#define __IDLE_H__

/////////////////////////////////////////////////////////////////////////////
// Includes
/////////////////////////////////////////////////////////////////////////////

#include <si_toolchain.h>
#include <stdint.h>
#include <stdbool.h>

/////////////////////////////////////////////////////////////////////////////
// Definitions
/////////////////////////////////////////////////////////////////////////////

#define DEFAULT_IDLE_RATE_MS    0       // Rate defined in the HID class doc.
                                        // 0 - infinite for joysticks/mice
#define POLL_RATE_MS            8       // The bInterval reported with the
                                        // interrupt IN endpoint descriptor.

/////////////////////////////////////////////////////////////////////////////
// Structures
/////////////////////////////////////////////////////////////////////////////

typedef struct
{
  uint8_t duration;   ///< idle duration in units of 4 ms
  uint16_t timer;     ///< idle timer 1 ms ticks remaining before next report
} idleTimer_TypeDef;

/////////////////////////////////////////////////////////////////////////////
// Prototypes
/////////////////////////////////////////////////////////////////////////////

void idleTimerStart(void);
void idleTimerTick(void);
bool isIdleTimerIndefinite(void);
bool isIdleTimerExpired(void);
void idleSetDuration(uint8_t duration);
uint8_t idleGetDuration(void);

#endif
